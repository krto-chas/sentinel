apiVersion: v1
kind: ConfigMap
metadata:
  name: sentinel-app-config
  namespace: sentinel
  labels:
    app.kubernetes.io/name: sentinel-upload-api
    app.kubernetes.io/part-of: sentinel-platform
data:
  SCANNER_MODE: "clamav"
  CLAMAV_HOST: "clamav"
  CLAMAV_PORT: "3310"
  CLAMAV_TIMEOUT_SECONDS: "5"
  UPLOAD_RATE_LIMIT_PER_MINUTE: "10"
  UPLOAD_RATE_LIMIT_WINDOW_SECONDS: "60"
  UPLOAD_LIST_LIMIT_DEFAULT: "25"
  UPLOAD_LIST_LIMIT_MAX: "100"
  UPLOAD_RETENTION_DAYS: "30"
  CISA_KEV_URL: "https://raw.githubusercontent.com/cisagov/kev-data/develop/known_exploited_vulnerabilities.json"
  CISA_KEV_MIN_SECONDS_BETWEEN_CALLS: "300"
  CISA_KEV_CACHE_TTL_SECONDS: "300"
  CISA_KEV_TIMEOUT_SECONDS: "8"
  CISA_KEV_USER_AGENT: "SentinelUploadAPI/1.0 (+https://sentinel-upload.secion.se)"
  AUTH_MODE: "off"
  FEODO_TRACKER_URL: "https://feodotracker.abuse.ch/downloads/ipblocklist.json"
  URLHAUS_RECENT_URL: "https://urlhaus.abuse.ch/downloads/json_recent/"
  URLHAUS_MAX_ITEMS: "1000"
  THREATFOX_API_URL: "https://threatfox-api.abuse.ch/api/v1/"
  THREATFOX_MAX_ITEMS: "200"
  THREATFOX_DAYS: "7"
  THREAT_INTEL_MIN_CONFIDENCE: "70"
  THREAT_INTEL_MAX_EVENTS_PER_RUN: "500"
  THREAT_INTEL_ALLOWED_SOURCES: "Feodo Tracker,URLhaus,ThreatFox"
  THREAT_RESOLVE_DOMAINS: "false"
  THREAT_LOOKBACK_DAYS: "90"
  GEOIP_DB_PATH: "/app/assets/GeoLite2-City.mmdb"
